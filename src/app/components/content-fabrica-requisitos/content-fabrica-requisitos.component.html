<div class="content">

    <div class="content-grid-list">
        <ul class="grid-list grid-list-fix">
            <li>
                <h5>Solicitud #</h5>
                <span>{{mensajeServicio.NumeroCredito}}</span>
            </li>
            <li>
                <h5>Cédula</h5>
                <span>{{mensajeServicio.Cedula}}</span>
            </li>
            <li>
                <h5>Nombre</h5>
                <span>{{mensajeServicio.NombreConsultado}}</span>
            </li>
            <li>
                <h5>Estado<img src="assets/images/update.png" (click)="incializarCredito()" /></h5>
                <span class="tag">{{mensajeServicio.Estado}}</span>
            </li>
            <li>
                <h5>Sub-estado</h5>
                <span>{{mensajeServicio.SubEstado}}</span>
            </li>
            <li>
                <h5>Fecha Creación</h5>
                <span>{{mensajeServicio.FechaCreacion}}</span>
            </li>
            <li>
                <h5>Tipo de Crédito</h5>
                <span>{{mensajeServicio.TipoCredito}}</span>
            </li>
        </ul>
        <ul class="grid-list">
            <li>
                <h5>Perfil Aplicado</h5>
                <span>{{mensajeServicio.PerfilAplicado}}</span>
            </li>
            <li>
                <h5>Score</h5>
                <span>{{mensajeServicio.ScoreDeudor}}</span>
            </li>
            <li>
                <h5>Ingreso Validado</h5>
                <span>{{mensajeServicio.IngresoValidado}}</span>
            </li>
            <li>
                <h5>Asesor Asociado</h5>
                <select>
                    <option>{{mensajeServicio.AsesorAsociado}}</option>
                </select>
            </li>
            <li>
                <h5>Valor de la Venta</h5>
                <span>{{mensajeServicio.ValorTotal}}</span>
            </li>
            <li>
                <h5>Valor de la Entrada</h5>
                <span>{{mensajeServicio.Entrada}}</span>
            </li>
            <li>
                <h5>Valor Crédito Solicitado</h5>
                <span>{{mensajeServicio.Monto}}</span>
            </li>
        </ul>
    </div>

    <app-steps></app-steps>

    <form class="steps-mobile">
        <select id='selectSteps'>
                <option value='datos-basicos'>Datos básicos</option>
                <option value='credito'>Crédito</option>
                <option value='solicitud-credito'>Solicitud Crédito</option>
                <option value='requisitos' selected>Requisitos</option>
                <option value='politicas'>Políticas</option>
                <option value='generacion'>Generación</option>
                <option value='control-calidad'>Control Calidad</option>
                <option value='resumen'>Resumen</option>
            </select>
    </form>

    <div class="forms forms-relative">
        <div class="buscador-general">
            <label class="label">Buscador General</label>
            <input type="text" placeholder="Filtrar">
        </div>
        <div id="table-scroll">
            <table class="width-filters">
                <thead>
                    <tr>
                        <th><input type="checkbox" (change)="marcarTodos($event)" [checked]=false></th>
                        <th>Solicitar Excepción</th>
                        <th>Estado</th>
                        <th>Url</th>
                        <th>Política</th>
                        <th>Requisito</th>
                        <th>Aprobado</th>
                        <th>Usuario Aprobado</th>
                        <th>Fecha Aprobado</th>
                        <th>Validado</th>
                        <th>Observaciones Validado</th>
                        <th>Usuario Archivo</th>
                        <th>Fecha Archivo</th>
                        <th>Nombre Archivo</th>
                        <th>Observaciones</th>
                        <th>Usuario Solicitud Excepción</th>
                        <th>Fecha Solicitud Excepción</th>
                        <th>Usuario Excepcionado</th>
                        <th>Fecha Excepcionado</th>
                        <th>Id</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let requisito of requisitios | paginate: {itemsPerPage: 10, currentPage: paginaAcual}, let i = index">
                        <td><input class="form-check-input" type="checkbox" [checked]="marcarChecks" name="miDataInterior" (change)="$event.target.checked ? agregar(requisito) : quitar(requisito)"></td>
                        <td><a *ngIf="SolicitarExcepcion" class="tag-with-radius" (click)="openCustomWidthVariant(solicitudExcepcion, requisito)">Solicitar</a></td>
                        <td><span class="{{requisito.COLOR_UX}}"></span></td>
                        <td *ngIf="requisito.URL_DOC">
                            <a href="{{requisito.URL_DOC}}" target="_blank"><img src="assets/images/icon-url.svg" class="check-center"></a>
                        </td>
                        <td *ngIf="!requisito.URL_DOC">
                            <a></a>
                        </td>
                        <td>{{requisito.NOM_POL}}</td>
                        <td>{{requisito.VALOR_MAT}}</td>
                        <td><img src="{{requisito.CHECK_UX}}" class="check-center"></td>
                        <td>{{requisito.USR_VAL}}</td>
                        <td>{{requisito.FECH_VAL | date: 'yyyy-MM-dd'}}</td>
                        <td>{{requisito.VALIDADO_VAL}}</td>
                        <td>{{requisito.OBS_VAL_VAL}}</td>
                        <td>{{requisito.USR_CARGA_ARCH_VAL}}</td>
                        <td>{{requisito.FCH_CARGA_ARCH_VAL}}</td>
                        <td>{{requisito.NombreCorto}}</td>
                        <td>{{requisito.OBSER_VAL_EXC_VAL}}</td>
                        <td>{{requisito.USR_EXC_VAL}}</td>
                        <td>{{requisito.FECH_EXC_VAL | date: 'yyyy-MM-dd'}}</td>
                        <td>{{requisito.USR_VAL_EXC_VAL}}</td>
                        <td>{{requisito.FECH_VAL_EXC_VAL | date: 'yyyy-MM-dd'}}</td>
                        <td>{{requisito.ID_VAL}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <pagination-controls class="my-pagination align-content-center label" previousLabel="Anterior" nextLabel="Siguiente" screenReaderPaginationLabel="Pagination" screenReaderPageLabel="page" autoHide="true" (pageChange)="paginaAcual = $event"></pagination-controls>
    </div>
    <div class="footer-fixed-forms">
        <div class="cols cols2">
            <div class="align-left">
                <button class="btn btn-border-blue" (click)="openCustomWidthVariant(verHistorial,'')"><img src="assets/images/icon-reloj.svg">Historial</button>
                <button *ngIf="btnSolicitarAnulacion" class="btn btn-border-blue" (click)="openCustomWidthVariantCancelar(cancelarSolicitud)">Cancelar solicitud</button>
                <button class="btn btn-border-blue btn-cancel" (click)="openLg(verDocumentacion)"><img src="assets/images/icon-folder.svg">Documentación</button>
                <a *ngIf="SubirArchivos" class="btn btn-border-blue simulate-inputFile">Subir archivos <input type="file" (change)="onFileSelected($event,mensajeModalError, mensajeAdvertencia)" *ngIf="subirArchivo()" ></a>
            </div>
            <div class="align-right">
                <!-- <button class="btn btn-border-gray">Cancelar</button> -->
                <button *ngIf="btnSolicitarAnalisis" class="btn btn-solid-green" (click)="solicitarAnalisis(mensajeModalError)">Solicitar análisis</button>
                <button *ngIf="ASPxActualizarSOL" class="btn btn-solid-green">Guardar</button>
                <button class="btn btn-solid-blue">Siguiente</button>
            </div>
        </div>
    </div>
</div>


<ng-template #verDocumentacion let-modal>
    <div class="modal-header-mfc variation ">
        <div class="cols cols2 align-middle ">
            <div class="align-left ">
                <img width="20 " alt="MICRO FACTORY CAPITAL " src="./assets/images/icon-documentacion-modal.svg ">
                <h4 class="modal-minititle-mfc ">Documentación</h4>
            </div>
            <div class="align-right ">
                <button type="button " class="close " aria-label="Close " (click)="modal.dismiss( 'Close click') ">
                    <span aria-hidden="true ">&times;</span>
                </button>
            </div>
        </div>
    </div>
    <div class="modal-body variation ">
        <div class="forms forms-relative ">
            <label class="label ">Nuevo archivo</label>
            <div class="false-inputfile ">
                <input type="text " disabled placeholder="Elija un archivo para subir... ">
                <button *ngIf="SubirArchivos" class="btn btn-solid-blue " type="button " (click)="fileInput.click() ">
                    <span>Cargar archivo</span>
                    <input #fileInput type="file " style="display:none; " />
                </button>
            </div>
            <div class="drag-div ">Arrastra una columna aquí para agrupar por dicha columna</div>
            <div id="table-scroll ">
                <table class="width-filters ">
                    <thead>
                        <tr>
                            <th><input type="checkbox "></th>
                            <th>
                                <select class="filter-for-table ">
                                    <option>Nombre de documento</option>
                                </select>
                            </th>
                            <th>
                                <select class="filter-for-table ">
                                    <option>Fecha ingreso</option>
                                </select>
                            </th>
                            <th>
                                <select class="filter-for-table ">
                                    <option>Usuario Ingreso</option>
                                </select>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="tr-filters ">
                            <td></td>
                            <td>
                                <div class="component-filter "><input type="text "><span class="btn-filter "><img src="assets/images/icon-filter.svg "></span></div>
                            </td>
                            <td>
                                <div class="component-filter "><input type="text "><span class="btn-filter "><img src="assets/images/icon-filter.svg "></span></div>
                            </td>
                            <td>
                                <div class="component-filter "><input type="text "><span class="btn-filter "><img src="assets/images/icon-filter.svg "></span></div>
                            </td>
                        </tr>
                        <tr *ngFor="let documento of documentosSubidos">
                            <td><input type="checkbox "></td>
                            <td>
                                <a href="{{documento.URL_DOC}}" target="_blank" class="link-doc "><img src="assets/images/icon-document-list.svg ">{{documento.NOM_DOC}}</a>
                            </td>
                            <td>{{documento.FCH_DOC}}</td>
                            <td>{{documento.USR_DOC}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="modal-footer-mfc full variation ">
        <div class="align-right ">
            <button class="btn btn-solid-blue " (click)="modal.close( 'Cancelar click') ">Cerrar</button>
        </div>
    </div>
</ng-template>

<ng-template #verHistorial let-modal>
    <div class="modal-header-mfc variation">
        <div class="cols cols2 align-middle">
            <div class="align-left">
                <img width="20" alt="MICRO FACTORY CAPITAL" src="./assets/images/icon-historial-modal.svg">
                <h4 class="modal-minititle-mfc">Historial</h4>
            </div>
            <div class="align-right">
                <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Close click')">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        </div>
    </div>
    <app-modal-historial></app-modal-historial>
    <div class="modal-footer-mfc full variation">
        <div class="cols cols2">
            <div class="align-left">
                <button class="btn btn-border-blue" routerLink="/configuracion/respuestas" (click)="modal.close('Cancelar click')">Generar respuesta</button>
            </div>
            <div class="align-right">
                <button class="btn btn-solid-blue" (click)="modal.close('Cancelar click')">Guardar</button>
            </div>
        </div>
    </div>
</ng-template>


<ng-template #solicitudExcepcion let-modal>

    <div class="modal-header-mfc variation">
        <div class="cols cols2 align-middle">
            <div class="align-left">
                <img width="20" alt="MICRO FACTORY CAPITAL" src="./assets/images/icon-documentacion-modal.svg">
                <h4 class="modal-minititle-mfc">Solicitud de Excepción</h4>
            </div>
            <div class="align-right">
                <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Close click')">
                  <span aria-hidden="true">&times;</span>
              </button>
            </div>
        </div>
    </div>

    <div class="modal-body variation">
        <div class="modal-with-viewer modal-without-pdf">
            <div class="forms forms-relative">
                <div class="cols cols2">
                    <div>
                        <fieldset>
                            <label class="label">ID</label>
                            <span class="text-data">{{requisitoExepcion.ID_VAL}}</span>
                        </fieldset>
                    </div>
                    <div>
                        <fieldset>
                            <label class="label">Tipo</label>
                            <span class="text-data">Requisito</span>
                        </fieldset>
                    </div>
                </div>
                <fieldset>
                    <label class="label">Comentarios</label>
                    <textarea placeholder="Escriba Comentarios" style="max-height: 100px;" id="comentarioExcepcion" name="comentarioExcepcion" [(ngModel)]="comentarioExcepcion"></textarea>
                </fieldset>
                <div id="table-scroll">
                    <table class="width-filters" style="max-width: calc(100% - 8px);margin-top: 8px;">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Validación</th>
                                <th>Fecha</th>
                                <th>Usuario</th>
                                <th>Observaciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let excepcion of excepciones">
                                <td>&nbsp;</td>
                                <td>{{excepcion.VALIDADO_VPOL}}</td>
                                <td>{{excepcion.USR_VAL_VPOL}}</td>
                                <td>{{excepcion.FECH_VAL_VPOL}}</td>
                                <td>{{excepcion.OBS_VAL_VPOL}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-footer-mfc full variation">
        <div class="align-right">
            <button class="btn btn-border-gray" (click)="modal.close('Cancelar click')">Cancelar</button>
            <button *ngIf="SolicitarExcepcion" class="btn btn-solid-green" (click)="guardarExcepcion(mensajeAdvertencia, mensajeModalError)">Guardar</button>
        </div>
    </div>

</ng-template>

<ngb-alert *ngIf="successMessage" type="success" class="wbtn-success" (close)="successMessage = null"><img src="./assets/images/success.svg"><span>{{ successMessage }}</span></ngb-alert>

<ng-template #cancelarSolicitud let-modal>
    <div class="modal-header-mfc variation">
        <div class="cols cols2 align-middle">
            <div class="align-left">
                <img width="20" alt="MICRO FACTORY CAPITAL" src="./assets/images/icon-folder.svg">
                <h4 class="modal-minititle-mfc">Cancelar Solicitud</h4>
            </div>
            <div class="align-right">
                <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Close click')">
                  <span aria-hidden="true">&times;</span>
              </button>
            </div>
        </div>
    </div>

    <div class="modal-body variation">
        <div class="forms forms-relative" style="margin: 20px -8px 0;padding: 0;">
            <fieldset>
                <label class="label">Ingrese el motivo para cancelar la solicitud:</label>
                <textarea #motivoCancelacion placeholder="Escriba el motivo" style="max-height: 100px;"></textarea>
            </fieldset>
        </div>
    </div>

    <div class="modal-footer-mfc full variation">
        <div class="align-right">
            <button class="btn btn-solid-blue" (click)="generarCancelacion(motivoCancelacion.value)">Cancelar Solicitud</button>
        </div>
    </div>
</ng-template>

<ng-template #mensajeModalError let-modal>
    <div class="modal-error">
        <div>
            <div class="cols cols2 align-middle">
                <div class="align-left">
                    <img src="./assets/images/warning.svg" width="42">
                    <p>{{errorMessage}}</p>
                </div>
            </div>
        </div>
        <div class="align-right">
            <button class="btn btn-solid-white" (click)="modal.close('Cancelar click')">Aceptar</button>
        </div>
    </div>
</ng-template>

<ng-template #mensajeAdvertencia let-modal>
    <div class="modal-header-mfc variation modal-mensaje">
        <div class="cols cols2 align-middle">
            <div class="align-left">
                <img width="32" alt="MICRO FACTORY CAPITAL" src="./assets/images/icon-mensaje-warning.svg">
                <h4 class="modal-minititle-mfc">Importante</h4>
            </div>
            <div class="align-right">
                <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Close click')">
          <span aria-hidden="true">&times;</span>
        </button>
            </div>
        </div>
    </div>

    <div class="modal-body variation modal-mensaje">
        <p>{{advertenceMessage}}</p>
    </div>
    <div class="modal-footer-mfc full variation">
        <div class="cols cols2">

            <div class="align-right">
                <button class="btn btn-solid-green" (click)="modal.close('Cancelar click')">Aceptar</button>
            </div>
        </div>
    </div>
</ng-template>